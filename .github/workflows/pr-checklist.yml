name: PR Checklist for Frontend

on:
  pull_request:
    branches: [main]
    types: [opened, reopened, edited, review_requested, synchronize, labeled]
  push:
    branches:
      - "main"
  workflow_call:

jobs:
  check:
    name: Add Checklist if "frontend" Label is Present
    runs-on: ubuntu-latest  # Using Ubuntu as specified
    steps:
      - name: Check PR labels and add checklist
        uses: actions/github-script@v7
        with:
          script: |
            console.log("Workflow started...");
            
            const pr = context.payload.pull_request;
            if (!pr) {
              console.log("No PR context found.");
              return;
            }

            console.log(`PR found: #${pr.number}, Title: "${pr.title}"`);

            const labels = pr.labels.map(label => label.name);
            console.log(`Labels on PR: ${labels}`);

            if (!labels.includes("frontend")) {
              console.log("Skipping checklist: PR does not have 'frontend' label.");
              return;
            }

            console.log("Frontend label found. Adding checklist...");

            const checklist = `
            ## ✅ PR Checklist for Frontend  
            - [ ] Código revisado  
            - [ ] Pruebas unitarias agregadas  
            - [ ] Documentación actualizada  
            - [ ] Aprobación de al menos un revisor  
            `;

            github.rest.issues.createComment({
              issue_number: pr.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: checklist
            }).then(response => {
              console.log("Checklist comment added successfully!");
            }).catch(error => {
              console.log("Error adding checklist comment:", error);
            });


